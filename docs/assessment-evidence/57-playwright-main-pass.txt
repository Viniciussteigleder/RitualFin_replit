
> rest-express@1.0.1 test:e2e
> playwright test


========================================
Rules Engine Unit Tests
Logic Contract: docs/LOGIC_CONTRACT.md
========================================

TC-001: Testing determinism...
  âœ“ TC-001 passed: Deterministic output
TC-002: Testing strict rule short-circuit...
  âœ“ TC-002 passed: Strict rule short-circuits correctly
TC-003: Testing priority order...
  âœ“ TC-003 passed: Higher priority wins
TC-004: Testing negative keywords...
  âœ“ TC-004 passed: Negative keywords exclude correctly
TC-005: Testing Interno auto-flagging...
  âœ“ TC-005 passed: Interno auto-flags correctly
TC-006: Manual override preservation...
  âš  Note: Full test requires database integration
  âœ“ TC-006 skipped: Tested at integration level
TC-007: Testing conflict detection...
  âœ“ TC-007 passed: Conflict detection works
TC-008: Testing confidence threshold...
  âœ“ TC-008 passed: Confidence threshold respected
TC-009: Testing inactive rule handling...
  âœ“ TC-009 passed: Inactive rules ignored
TC-010: Testing negative keyword exclusion in matchRules...
  âœ“ TC-010 passed: matchRules respects negative keywords
EC-001: Testing empty keywords handling...
  âœ“ EC-001 passed: Empty keywords handled
EC-002: Testing special characters...
  âœ“ EC-002 passed: Special characters work
EC-003: Testing unicode normalization...
  âœ“ EC-003 passed: Unicode normalization works
EC-004: Testing case insensitivity...
  âœ“ EC-004 passed: Case insensitivity works

========================================
Results: 14 passed, 0 failed
========================================


Running 14 tests using 4 workers

[1A[2K[1/14] [chromium] â€º tests/auth_harden.spec.ts:2:1 â€º Auth debug endpoint is not exposed in production
[1A[2K[2/14] [chromium] â€º tests/auth-flow.spec.ts:21:3 â€º Auth Flow â€º should redirect to login when accessing protected route while logged out
[1A[2K[3/14] [chromium] â€º tests/auth_harden.spec.ts:8:1 â€º Auth route does not immediately error
[1A[2K[4/14] [chromium] â€º tests/auth-flow.spec.ts:3:3 â€º Auth Flow â€º should load login page and show Google sign-in button
[1A[2K[5/14] [chromium] â€º tests/auth-flow.spec.ts:30:3 â€º Auth Flow â€º health endpoint should return OK status
[1A[2K[6/14] [chromium] â€º tests/auth-flow.spec.ts:40:3 â€º Application Health â€º homepage should load
[1A[2K[7/14] [chromium] â€º tests/auth-flow.spec.ts:50:3 â€º Application Health â€º should have no console errors on login page
[1A[2K[8/14] [chromium] â€º tests/auth.spec.ts:3:3 â€º Authentication â€º login page renders and shows error on missing config
[1A[2K[9/14] [chromium] â€º tests/auth.spec.ts:20:3 â€º Authentication â€º signup and login flow
[1A[2K[10/14] [chromium] â€º tests/ingestion.spec.ts:19:3 â€º Ingestion Flow â€º upload CSV, preview, commit and rollback
[1A[2K[11/14] [chromium] â€º tests/screens.spec.ts:3:1 â€º Routes: protected screens redirect when logged out
[1A[2K[WebServer] [31m[auth][error][0m CredentialsSignin: Read more at https://errors.authjs.dev#credentialssignin

[1A[2K[WebServer]     at ad (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/_2500f2ad._.js:404:40935)
[WebServer]     at process.processTicksAndRejections (node:internal/process/task_queues:103:5)
[WebServer]     at async ax (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/_2500f2ad._.js:404:50360)
[WebServer]     at async aw (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/_2500f2ad._.js:404:54610)
[WebServer]     at async rU.do (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.prod.js:5:20169)
[WebServer]     at async rU.handle (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.prod.js:5:24949)
[WebServer]     at async u (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/[root-of-the-server]__6ea5f74b._.js:1:4815)
[WebServer]     at async rU.handleResponse (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/node_modules/next/dist/compiled/next-server/app-route-turbo.runtime.prod.js:1:101467)
[WebServer]     at async d (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/[root-of-the-server]__6ea5f74b._.js:1:5856)
[WebServer]     at async Module.C (/Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/.next/server/chunks/[root-of-the-server]__6ea5f74b._.js:1:6934)

[1A[2K[12/14] [chromium] â€º tests/screens.spec.ts:15:1 â€º Routes: authenticated screens load without server errors
[1A[2K[13/14] [chromium] â€º tests/screenshot.spec.ts:19:3 â€º Screenshot Ingestion â€º upload screenshot with mocked OCR and verify enrichment
[1A[2K[14/14] [chromium] â€º tests/smoke-test.spec.ts:2:1 â€º app loads without runtime errors
[1A[2K[chromium] â€º tests/smoke-test.spec.ts:2:1 â€º app loads without runtime errors
âœ… Login page loads successfully

[1A[2KFinal URL: http://localhost:3001/

[1A[2Kâœ… No schema errors detected

[1A[2K  1) [chromium] â€º tests/ingestion.spec.ts:19:3 â€º Ingestion Flow â€º upload CSV, preview, commit and rollback 

    Error: [2mexpect([22m[31mlocator[39m[2m).[22mtoBeVisible[2m([22m[2m)[22m failed

    Locator: getByText('REWE')
    Expected: visible
    Timeout: 20000ms
    Error: element(s) not found

    Call log:
    [2m  - Expect "toBeVisible" with timeout 20000ms[22m
    [2m  - waiting for getByText('REWE')[22m


      33 |     // Verify in transactions
      34 |     await page.goto('/transactions');
    > 35 |     await expect(page.getByText('REWE')).toBeVisible({ timeout: 20000 });
         |                                          ^
      36 |
      37 |     // Rollback
      38 |     await page.goto('/uploads');
        at /Users/viniciussteigleder/Documents/Web apps - vide coding/RitualFin_replit_local/RitualFin_replit/tests/ingestion.spec.ts:35:42

    Error Context: test-results/ingestion-Ingestion-Flow-u-2848a-preview-commit-and-rollback-chromium/error-context.md


[1A[2K  1 failed
    [chromium] â€º tests/ingestion.spec.ts:19:3 â€º Ingestion Flow â€º upload CSV, preview, commit and rollback 
  13 passed (49.4s)
