{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../src/lib/actions/transactions.ts","../../../../.next-internal/server/app/%28dashboard%29/transactions/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\";\n\nimport { auth } from \"@/auth\";\nimport { db } from \"@/lib/db\";\nimport { transactions } from \"@/lib/db/schema\";\nimport { eq, desc } from \"drizzle-orm\";\nimport { revalidatePath } from \"next/cache\";\n\nexport async function getTransactions(limit = 50) {\n  const session = await auth();\n  if (!session?.user?.id) return [];\n\n  // TODO: Add filtering and pagination support\n  return await db.query.transactions.findMany({\n    where: (tx, { eq }) => eq(tx.userId, session.user.id),\n    orderBy: [desc(transactions.date)],\n    limit: limit,\n    with: {\n      rule: true,\n      evidenceLinks: {\n        with: {\n          ingestionItem: true\n        }\n      }\n    }\n  });\n}\n\nexport async function updateTransactionCategory(\n  transactionId: string, \n  data: { category1: string; category2?: string; category3?: string }\n) {\n  const session = await auth();\n  if (!session?.user?.id) return { error: \"Unauthorized\" };\n\n  await db.update(transactions)\n    .set({\n      category1: data.category1,\n      category2: data.category2,\n      category3: data.category3,\n      needsReview: false, // Auto-confirm on manual edit\n      isManual: true\n    })\n    .where(eq(transactions.id, transactionId));\n\n  revalidatePath(\"/transactions\");\n  revalidatePath(\"/\"); // Dashboard\n  return { success: true };\n}\n\nexport async function confirmTransaction(transactionId: string) {\n    const session = await auth();\n    if (!session?.user?.id) return { error: \"Unauthorized\" };\n\n    await db.update(transactions)\n        .set({ needsReview: false })\n        .where(eq(transactions.id, transactionId));\n\n    revalidatePath(\"/transactions\");\n    return { success: true };\n}\n","export {getTransactions as '407d670708f39c60750dfad5d03b4ea1070389c3fa'} from 'ACTIONS_MODULE0'\nexport {confirmTransaction as '40e8b8804edc58331a855a9e5bc7f160e8a3939790'} from 'ACTIONS_MODULE0'\nexport {updateTransactionCategory as '60395fe9d06ede9e512eadd233111ed254df3c043c'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"gNAAoD,OAAA,cAAA,CAAA,EAAA,aAAA,oCAC3CA,0BAAAA,qCAAAA,EAAAA,uBAAuB,YAAQ,CAAA,CAAA,IAAA,iCCEjC,SAASC,EAAyBC,CAAc,EACrD,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAQE,MAAM,CAAED,IAAK,CACvC,IAAME,EAASH,CAAO,CAACC,EAAE,CACzB,GAAsB,YAAlB,AAA8B,OAAvBE,EACT,MAAM,OAAA,cAEL,CAFK,AAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,EAAO;AAAA,oEAAuE,CAAC,EADhJ,oBAAA,OAAA,mBAAA,gBAAA,CAEN,EAEJ,CACF,0EATgBJ,2BAAAA,qCAAAA,qDCDhB,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,+BAEO,eAAe,EAAgB,EAAQ,EAAE,EAC9C,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,IAAA,AAAI,WACrB,AAAL,GAAc,CAAV,KAAgB,GAGb,CAHiB,KAGX,EAAA,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,CAC1C,MAAO,CAAC,EAAI,IAAE,CAAE,CAAE,GAAK,EAAG,EAAG,MAAM,CAAE,EAAQ,IAAI,CAAC,EAAE,EACpD,QAAS,CAAC,CAAA,EAAA,EAAA,IAAA,AAAI,EAAC,EAAA,YAAY,CAAC,IAAI,EAAE,CAClC,MAAO,EACP,KAAM,CACJ,MAAM,EACN,cAAe,CACb,KAAM,CACJ,eAAe,CACjB,CACF,CACF,CACF,GAf+B,EAgBjC,AAhBmC,CAkB5B,eAAe,EACpB,CAAqB,CACrB,CAAmE,EAEnE,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,IAAA,AAAI,WAC1B,AAAK,GAAS,CAAV,KAAgB,IAAI,AAExB,MAAM,EAAA,EAAE,CAAC,MAAM,CAAC,EAAA,YAAY,EACzB,GAAG,CAAC,CACH,UAAW,EAAK,SAAS,CACzB,UAAW,EAAK,SAAS,CACzB,UAAW,EAAK,SAAS,CACzB,aAAa,EACb,UAAU,CACZ,GACC,KAAK,CAAC,CAAA,EAAA,EAAA,EAAA,AAAE,EAAC,EAAA,YAAY,CAAC,EAAE,CAAE,IAE7B,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,iBACf,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,KACR,CADc,AACZ,QAAS,EAAK,EADU,CAbF,CAAE,MAAO,cAAe,CAezD,CAEO,eAAe,EAAmB,CAAqB,EAC1D,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,IAAA,AAAI,WAC1B,AAAK,GAAS,CAAV,KAAgB,IAAI,AAExB,MAAM,EAAA,EAAE,CAAC,MAAM,CAAC,EAAA,YAAY,EACvB,GAAG,CAAC,CAAE,aAAa,CAAM,GACzB,KAAK,CAAC,CAAA,EAAA,EAAA,EAAA,AAAE,EAAC,EAAA,YAAY,CAAC,EAAE,CAAE,IAE/B,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,iBACR,CAAE,SAAS,CAAK,GAPQ,CAAE,MAAO,cAAe,CAQ3D,4DApDsB,EAoBA,EAsBA,IA1CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAoBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,wJClDtB,IAAA,EAAA,EAAA,CAAA,CAAA","ignoreList":[0,1]}