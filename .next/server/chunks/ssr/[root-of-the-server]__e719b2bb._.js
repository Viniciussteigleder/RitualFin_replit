module.exports=[54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},23862,a=>a.a(async(b,c)=>{try{let b=await a.y("pg-587764f78a6c7a9c");a.n(b),c()}catch(a){c(a)}},!0),37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},89806,a=>{"use strict";function b(a){return a.toUpperCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim()}function c(a){let b=70;return a.isSystem&&(b+=10),a.priority>=800?b+=15:a.priority>=600?b+=10:a.priority>=500&&(b+=5),a.strict&&(b=100),Math.min(b,100)}function d(a,e,f={}){let g=function(a,d,e={}){let{autoConfirmHighConfidence:f=!1,confidenceThreshold:g=80}=e,h=b(a),i=[];for(let a of[...d].sort((a,b)=>(b.priority||500)-(a.priority||500))){if(!a.keywords&&!a.keyWords)continue;let c=(a.keyWords||a.keywords||"").split(";").map(a=>b(a)).filter(a=>a.length>0).find(a=>h.includes(a));if(c){let b={ruleId:a.id,type:a.type||"Despesa",fixVar:a.fixVar||"VariÃ¡vel",category1:a.category1||"Outros",category2:a.category2||void 0,category3:a.category3||void 0,priority:a.priority||500,strict:a.strict||!1,isSystem:a.isSystem||!1,matchedKeyword:c};if(a.strict)return{needsReview:!1,matches:[b],appliedRule:b,confidence:100,reason:"Regra estrita aplicada automaticamente"};i.push(b)}}if(0===i.length)return{needsReview:!0,matches:[],confidence:0,reason:"Nenhuma regra encontrada"};if(1===i.length){let a=i[0],b=c(a),d=b>=g,e=f&&d;return{needsReview:!e,matches:i,appliedRule:a,confidence:b,reason:e?`Alta confianca (${b}%) - aplicado automaticamente`:d?`Alta confianca (${b}%) - revisar (auto-confirm desativado)`:`Confianca media (${b}%) - revisar`}}let j=i.filter(a=>a.priority===i[0].priority);if(1===j.length){let a=j[0],b=Math.min(c(a)-10,85),d=b>=g,e=f&&d;return{needsReview:!e,matches:i,appliedRule:a,confidence:b,reason:e?`Multiplas regras mas prioridade clara (${b}%)`:d?`Alta confianca (${b}%) - revisar (auto-confirm desativado)`:`Multiplas regras (${b}%) - revisar`}}return{needsReview:!0,matches:i,appliedRule:i[0],confidence:50,reason:`Conflito: ${i.length} regras com mesma prioridade`}}(a,e,f);if(g.appliedRule&&!g.needsReview){let a=g.appliedRule,b="Interno"===a.category1;return{type:a.type,fixVar:a.fixVar,category1:a.category1,category2:a.category2,category3:a.category3,needsReview:!1,ruleIdApplied:a.ruleId,internalTransfer:b,excludeFromBudget:b,confidence:g.confidence}}if(g.appliedRule&&g.needsReview){let a=g.appliedRule,b="Interno"===a.category1;return{type:a.type,fixVar:a.fixVar,category1:a.category1,category2:a.category2,category3:a.category3,needsReview:!0,ruleIdApplied:a.ruleId,internalTransfer:b,excludeFromBudget:b,confidence:g.confidence}}return{needsReview:!0,confidence:0}}a.s(["categorizeTransaction",()=>d],89806)},67109,a=>a.a(async(b,c)=>{try{var d=a.i(37936),e=a.i(22028),f=a.i(13148),g=a.i(93321),h=a.i(30385),i=a.i(77607),j=a.i(89806),k=a.i(18558),l=a.i(13095),m=b([e,i]);async function n(){let a=await (0,i.auth)();return a?.user?.id?await e.db.query.rules.findMany({where:(0,g.eq)(f.rules.userId,a.user.id),orderBy:[(0,h.desc)(f.rules.priority)]}):[]}async function o(a){let b=await (0,i.auth)();if(!b?.user?.id)return null;let c=await n();return(0,j.categorizeTransaction)(a,c)}async function p(a){let b=await (0,i.auth)();if(!b?.user?.id)throw Error("Unauthorized");await e.db.insert(f.rules).values({...a,userId:b.user.id}),(0,k.revalidatePath)("/rules")}[e,i]=m.then?(await m)():m,(0,l.ensureServerEntryExports)([n,o,p]),(0,d.registerServerReference)(n,"0098dadc982ce31f86c900227d53ab42740e48baaf",null),(0,d.registerServerReference)(o,"40dbc5236911bb8712ca108c1b9a5bb87de662f8b6",null),(0,d.registerServerReference)(p,"403c284cc4c30894195431ad16bc5addcaadb17ed6",null),a.s(["createRule",()=>p,"getRules",()=>n,"testRuleCategorization",()=>o]),c()}catch(a){c(a)}},!1),48442,a=>a.a(async(b,c)=>{try{var d=a.i(67109),e=b([d]);[d]=e.then?(await e)():e,a.s([]),c()}catch(a){c(a)}},!1),72600,a=>a.a(async(b,c)=>{try{var d=a.i(48442),e=a.i(67109),f=b([d,e]);[d,e]=f.then?(await f)():f,a.s(["0098dadc982ce31f86c900227d53ab42740e48baaf",()=>e.getRules,"403c284cc4c30894195431ad16bc5addcaadb17ed6",()=>e.createRule,"40dbc5236911bb8712ca108c1b9a5bb87de662f8b6",()=>e.testRuleCategorization]),c()}catch(a){c(a)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__e719b2bb._.js.map