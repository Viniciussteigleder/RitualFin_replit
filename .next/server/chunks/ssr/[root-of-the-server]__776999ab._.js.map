{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","../../../../src/components/ui/card.tsx","../../../../node_modules/class-variance-authority/dist/index.mjs","../../../../src/components/ui/button.tsx","../../../../node_modules/%40radix-ui/react-compose-refs/dist/index.mjs","../../../../node_modules/%40radix-ui/react-slot/dist/index.mjs","../../../../src/components/ui/badge.tsx","../../../../src/lib/rules/classification-utils.ts","../../../../src/lib/rules/engine.ts","../../../../src/lib/ingest/ocr-parser.ts","../../../../src/lib/actions/screenshots.ts","../../../../.next-internal/server/app/%28dashboard%29/uploads/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-xl border bg-card text-card-foreground shadow\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","/**\n * Copyright 2022 Joe Bell. All rights reserved.\n *\n * This file is licensed to you under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with the\n * License. You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR REPRESENTATIONS OF ANY KIND, either express or implied. See the\n * License for the specific language governing permissions and limitations under\n * the License.\n */ import { clsx } from \"clsx\";\nconst falsyToString = (value)=>typeof value === \"boolean\" ? `${value}` : value === 0 ? \"0\" : value;\nexport const cx = clsx;\nexport const cva = (base, config)=>(props)=>{\n        var _config_compoundVariants;\n        if ((config === null || config === void 0 ? void 0 : config.variants) == null) return cx(base, props === null || props === void 0 ? void 0 : props.class, props === null || props === void 0 ? void 0 : props.className);\n        const { variants, defaultVariants } = config;\n        const getVariantClassNames = Object.keys(variants).map((variant)=>{\n            const variantProp = props === null || props === void 0 ? void 0 : props[variant];\n            const defaultVariantProp = defaultVariants === null || defaultVariants === void 0 ? void 0 : defaultVariants[variant];\n            if (variantProp === null) return null;\n            const variantKey = falsyToString(variantProp) || falsyToString(defaultVariantProp);\n            return variants[variant][variantKey];\n        });\n        const propsWithoutUndefined = props && Object.entries(props).reduce((acc, param)=>{\n            let [key, value] = param;\n            if (value === undefined) {\n                return acc;\n            }\n            acc[key] = value;\n            return acc;\n        }, {});\n        const getCompoundVariantClassNames = config === null || config === void 0 ? void 0 : (_config_compoundVariants = config.compoundVariants) === null || _config_compoundVariants === void 0 ? void 0 : _config_compoundVariants.reduce((acc, param)=>{\n            let { class: cvClass, className: cvClassName, ...compoundVariantOptions } = param;\n            return Object.entries(compoundVariantOptions).every((param)=>{\n                let [key, value] = param;\n                return Array.isArray(value) ? value.includes({\n                    ...defaultVariants,\n                    ...propsWithoutUndefined\n                }[key]) : ({\n                    ...defaultVariants,\n                    ...propsWithoutUndefined\n                })[key] === value;\n            }) ? [\n                ...acc,\n                cvClass,\n                cvClassName\n            ] : acc;\n        }, []);\n        return cx(base, getVariantClassNames, getCompoundVariantClassNames, props === null || props === void 0 ? void 0 : props.class, props === null || props === void 0 ? void 0 : props.className);\n    };\n\n","import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n\" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n           // @replit: no hover, and add primary border\n           \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground shadow-sm border-destructive-border\",\n        outline:\n          // @replit Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color. Uses shadow-xs. no shadow on active\n          // No hover state\n          \" border [border-color:var(--button-outline)] shadow-xs active:shadow-none \",\n        secondary:\n          // @replit border, no hover, no shadow, secondary border.\n          \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // @replit no hover, transparent border\n        ghost: \"border border-transparent\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        // @replit changed sizes\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","// packages/react/compose-refs/src/compose-refs.tsx\nimport * as React from \"react\";\nfunction setRef(ref, value) {\n  if (typeof ref === \"function\") {\n    return ref(value);\n  } else if (ref !== null && ref !== void 0) {\n    ref.current = value;\n  }\n}\nfunction composeRefs(...refs) {\n  return (node) => {\n    let hasCleanup = false;\n    const cleanups = refs.map((ref) => {\n      const cleanup = setRef(ref, node);\n      if (!hasCleanup && typeof cleanup == \"function\") {\n        hasCleanup = true;\n      }\n      return cleanup;\n    });\n    if (hasCleanup) {\n      return () => {\n        for (let i = 0; i < cleanups.length; i++) {\n          const cleanup = cleanups[i];\n          if (typeof cleanup == \"function\") {\n            cleanup();\n          } else {\n            setRef(refs[i], null);\n          }\n        }\n      };\n    }\n  };\n}\nfunction useComposedRefs(...refs) {\n  return React.useCallback(composeRefs(...refs), refs);\n}\nexport {\n  composeRefs,\n  useComposedRefs\n};\n//# sourceMappingURL=index.mjs.map\n","// src/slot.tsx\nimport * as React from \"react\";\nimport { composeRefs } from \"@radix-ui/react-compose-refs\";\nimport { Fragment as Fragment2, jsx } from \"react/jsx-runtime\";\nvar REACT_LAZY_TYPE = Symbol.for(\"react.lazy\");\nvar use = React[\" use \".trim().toString()];\nfunction isPromiseLike(value) {\n  return typeof value === \"object\" && value !== null && \"then\" in value;\n}\nfunction isLazyComponent(element) {\n  return element != null && typeof element === \"object\" && \"$$typeof\" in element && element.$$typeof === REACT_LAZY_TYPE && \"_payload\" in element && isPromiseLike(element._payload);\n}\n// @__NO_SIDE_EFFECTS__\nfunction createSlot(ownerName) {\n  const SlotClone = /* @__PURE__ */ createSlotClone(ownerName);\n  const Slot2 = React.forwardRef((props, forwardedRef) => {\n    let { children, ...slotProps } = props;\n    if (isLazyComponent(children) && typeof use === \"function\") {\n      children = use(children._payload);\n    }\n    const childrenArray = React.Children.toArray(children);\n    const slottable = childrenArray.find(isSlottable);\n    if (slottable) {\n      const newElement = slottable.props.children;\n      const newChildren = childrenArray.map((child) => {\n        if (child === slottable) {\n          if (React.Children.count(newElement) > 1) return React.Children.only(null);\n          return React.isValidElement(newElement) ? newElement.props.children : null;\n        } else {\n          return child;\n        }\n      });\n      return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children: React.isValidElement(newElement) ? React.cloneElement(newElement, void 0, newChildren) : null });\n    }\n    return /* @__PURE__ */ jsx(SlotClone, { ...slotProps, ref: forwardedRef, children });\n  });\n  Slot2.displayName = `${ownerName}.Slot`;\n  return Slot2;\n}\nvar Slot = /* @__PURE__ */ createSlot(\"Slot\");\n// @__NO_SIDE_EFFECTS__\nfunction createSlotClone(ownerName) {\n  const SlotClone = React.forwardRef((props, forwardedRef) => {\n    let { children, ...slotProps } = props;\n    if (isLazyComponent(children) && typeof use === \"function\") {\n      children = use(children._payload);\n    }\n    if (React.isValidElement(children)) {\n      const childrenRef = getElementRef(children);\n      const props2 = mergeProps(slotProps, children.props);\n      if (children.type !== React.Fragment) {\n        props2.ref = forwardedRef ? composeRefs(forwardedRef, childrenRef) : childrenRef;\n      }\n      return React.cloneElement(children, props2);\n    }\n    return React.Children.count(children) > 1 ? React.Children.only(null) : null;\n  });\n  SlotClone.displayName = `${ownerName}.SlotClone`;\n  return SlotClone;\n}\nvar SLOTTABLE_IDENTIFIER = Symbol(\"radix.slottable\");\n// @__NO_SIDE_EFFECTS__\nfunction createSlottable(ownerName) {\n  const Slottable2 = ({ children }) => {\n    return /* @__PURE__ */ jsx(Fragment2, { children });\n  };\n  Slottable2.displayName = `${ownerName}.Slottable`;\n  Slottable2.__radixId = SLOTTABLE_IDENTIFIER;\n  return Slottable2;\n}\nvar Slottable = /* @__PURE__ */ createSlottable(\"Slottable\");\nfunction isSlottable(child) {\n  return React.isValidElement(child) && typeof child.type === \"function\" && \"__radixId\" in child.type && child.type.__radixId === SLOTTABLE_IDENTIFIER;\n}\nfunction mergeProps(slotProps, childProps) {\n  const overrideProps = { ...childProps };\n  for (const propName in childProps) {\n    const slotPropValue = slotProps[propName];\n    const childPropValue = childProps[propName];\n    const isHandler = /^on[A-Z]/.test(propName);\n    if (isHandler) {\n      if (slotPropValue && childPropValue) {\n        overrideProps[propName] = (...args) => {\n          const result = childPropValue(...args);\n          slotPropValue(...args);\n          return result;\n        };\n      } else if (slotPropValue) {\n        overrideProps[propName] = slotPropValue;\n      }\n    } else if (propName === \"style\") {\n      overrideProps[propName] = { ...slotPropValue, ...childPropValue };\n    } else if (propName === \"className\") {\n      overrideProps[propName] = [slotPropValue, childPropValue].filter(Boolean).join(\" \");\n    }\n  }\n  return { ...slotProps, ...overrideProps };\n}\nfunction getElementRef(element) {\n  let getter = Object.getOwnPropertyDescriptor(element.props, \"ref\")?.get;\n  let mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.ref;\n  }\n  getter = Object.getOwnPropertyDescriptor(element, \"ref\")?.get;\n  mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.props.ref;\n  }\n  return element.props.ref || element.ref;\n}\nexport {\n  Slot as Root,\n  Slot,\n  Slottable,\n  createSlot,\n  createSlottable\n};\n//# sourceMappingURL=index.mjs.map\n","import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // @replit\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \",\n  {\n    variants: {\n      variant: {\n        default:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary:\n          // @replit no hover because we use hover-elevate\n          \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          // @replit shadow-xs instead of shadow, no hover because we use hover-elevate\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n          // @replit shadow-xs\" - use badge outline variable\n        outline: \"text-foreground border [border-color:var(--badge-outline)]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","import type { Rule, AliasAssets } from \"@/lib/db/schema\";\n\nexport function normalizeForMatch(text: string): string {\n  return text\n    .toUpperCase()\n    .normalize(\"NFD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .replace(/\\s+/g, \" \")\n    .trim();\n}\n\nexport function splitKeyExpressions(input?: string | null): string[] {\n  if (!input) return [];\n  return input\n    .split(\";\")\n    .map((expr) => expr.trim())\n    .filter((expr) => expr.length > 0);\n}\n\nexport function findMatchedExpression(haystack: string, expressions: string[]): string | null {\n  for (const expr of expressions) {\n    if (haystack.includes(expr)) {\n      return expr;\n    }\n  }\n  return null;\n}\n\nexport function evaluateRuleMatch(keyDesc: string, rule: Rule) {\n  const haystack = normalizeForMatch(keyDesc);\n  const positives = splitKeyExpressions(rule.keyWords || rule.keywords || \"\");\n  const negatives = splitKeyExpressions(rule.keyWordsNegative);\n\n  const normalizedPositives = positives.map(normalizeForMatch);\n  const normalizedNegatives = negatives.map(normalizeForMatch);\n\n  const positiveMatch = findMatchedExpression(haystack, normalizedPositives);\n  const negativeMatch = findMatchedExpression(haystack, normalizedNegatives);\n\n  return {\n    positiveMatch,\n    negativeMatch,\n    isMatch: Boolean(positiveMatch) && !negativeMatch\n  };\n}\n\nexport function evaluateAliasMatch(keyDesc: string, alias: AliasAssets) {\n  const haystack = normalizeForMatch(keyDesc);\n  const expressions = splitKeyExpressions(alias.keyWordsAlias || \"\");\n  const normalized = expressions.map(normalizeForMatch);\n  const matched = findMatchedExpression(haystack, normalized);\n  return {\n    matched,\n    isMatch: Boolean(matched)\n  };\n}\n","// Rules Engine for AI-powered transaction categorization with confidence levels\n\nimport type { Rule, Transaction } from \"@/lib/db/schema\";\nimport { evaluateRuleMatch } from \"./classification-utils\";\n\nexport interface RuleMatch {\n  ruleId: string;\n  type: \"Despesa\" | \"Receita\";\n  fixVar: \"Fixo\" | \"Variável\";\n  category1: string;\n  category2?: string;\n  category3?: string;\n  priority: number;\n  strict: boolean;\n  isSystem: boolean;\n  matchedKeyword?: string;\n}\n\nexport interface CategorizationResult {\n  needsReview: boolean;\n  matches: RuleMatch[];\n  appliedRule?: RuleMatch;\n  confidence: number;\n  reason?: string;\n}\n\nfunction normalizeForMatch(text: string): string {\n  return text\n    .toUpperCase()\n    .normalize(\"NFD\")\n    .replace(/[\\u0300-\\u036f]/g, \"\")\n    .replace(/\\s+/g, \" \")\n    .trim();\n}\n\nexport interface UserSettings {\n  autoConfirmHighConfidence?: boolean;\n  confidenceThreshold?: number;\n}\n\nexport function matchRules(descNorm: string, rules: Rule[], settings: UserSettings = {}): CategorizationResult {\n  const {\n    autoConfirmHighConfidence = false,\n    confidenceThreshold = 80\n  } = settings;\n\n  const haystack = normalizeForMatch(descNorm);\n  const matches: RuleMatch[] = [];\n\n  const sortedRules = [...rules].sort((a, b) => (b.priority || 500) - (a.priority || 500));\n\n  for (const rule of sortedRules) {\n    if (!rule.keywords && !rule.keyWords) continue; // Skip rules without keywords\n\n    const keywordString = rule.keyWords || rule.keywords || \"\";\n    const keywords = keywordString\n      .split(\";\")\n      .map(k => normalizeForMatch(k))\n      .filter(k => k.length > 0);\n\n    const matchedKeyword = keywords.find(keyword => haystack.includes(keyword));\n\n    if (matchedKeyword) {\n      const match: RuleMatch = {\n        ruleId: rule.id,\n        type: rule.type || \"Despesa\",\n        fixVar: rule.fixVar || \"Variável\",\n        category1: rule.category1 || \"Outros\",\n        category2: rule.category2 || undefined,\n        category3: rule.category3 || undefined,\n        priority: rule.priority || 500,\n        strict: rule.strict || false,\n        isSystem: rule.isSystem || false,\n        matchedKeyword\n      };\n\n      if (rule.strict) {\n        return {\n          needsReview: false,\n          matches: [match],\n          appliedRule: match,\n          confidence: 100,\n          reason: \"Regra estrita aplicada automaticamente\"\n        };\n      }\n\n      matches.push(match);\n    }\n  }\n\n  if (matches.length === 0) {\n    return {\n      needsReview: true,\n      matches: [],\n      confidence: 0,\n      reason: \"Nenhuma regra encontrada\"\n    };\n  }\n\n  if (matches.length === 1) {\n    const match = matches[0];\n    const confidence = calculateConfidence(match);\n    const meetsThreshold = confidence >= confidenceThreshold;\n    const autoApply = autoConfirmHighConfidence && meetsThreshold;\n\n    return {\n      needsReview: !autoApply,\n      matches,\n      appliedRule: match,\n      confidence,\n      reason: autoApply\n        ? `Alta confianca (${confidence}%) - aplicado automaticamente`\n        : meetsThreshold\n          ? `Alta confianca (${confidence}%) - revisar (auto-confirm desativado)`\n          : `Confianca media (${confidence}%) - revisar`\n    };\n  }\n\n  const topMatches = matches.filter(m => m.priority === matches[0].priority);\n\n  if (topMatches.length === 1) {\n    const match = topMatches[0];\n    const confidence = Math.min(calculateConfidence(match) - 10, 85);\n    const meetsThreshold = confidence >= confidenceThreshold;\n    const autoApply = autoConfirmHighConfidence && meetsThreshold;\n\n    return {\n      needsReview: !autoApply,\n      matches,\n      appliedRule: match,\n      confidence,\n      reason: autoApply\n        ? `Multiplas regras mas prioridade clara (${confidence}%)`\n        : meetsThreshold\n          ? `Alta confianca (${confidence}%) - revisar (auto-confirm desativado)`\n          : `Multiplas regras (${confidence}%) - revisar`\n    };\n  }\n\n  return {\n    needsReview: true,\n    matches,\n    appliedRule: matches[0],\n    confidence: 50,\n    reason: `Conflito: ${matches.length} regras com mesma prioridade`\n  };\n}\n\nfunction calculateConfidence(match: RuleMatch): number {\n  let confidence = 70;\n  \n  if (match.isSystem) confidence += 10;\n  if (match.priority >= 800) confidence += 15;\n  else if (match.priority >= 600) confidence += 10;\n  else if (match.priority >= 500) confidence += 5;\n  \n  if (match.strict) confidence = 100;\n  \n  return Math.min(confidence, 100);\n}\n\nexport function categorizeTransaction(\n  descNorm: string,\n  rules: Rule[],\n  settings: UserSettings = {}\n): Partial<Transaction> & { confidence?: number } {\n  const result = matchRules(descNorm, rules, settings);\n  \n  if (result.appliedRule && !result.needsReview) {\n    const rule = result.appliedRule;\n    const isInterno = rule.category1 === \"Interno\";\n    \n    return {\n      type: rule.type,\n      fixVar: rule.fixVar,\n      category1: rule.category1 as any,\n      category2: rule.category2,\n      category3: rule.category3,\n      needsReview: false,\n      ruleIdApplied: rule.ruleId,\n      internalTransfer: isInterno,\n      excludeFromBudget: isInterno,\n      confidence: result.confidence\n    };\n  }\n\n  if (result.appliedRule && result.needsReview) {\n    const rule = result.appliedRule;\n    const isInterno = rule.category1 === \"Interno\";\n\n    return {\n      type: rule.type,\n      fixVar: rule.fixVar,\n      category1: rule.category1 as any,\n      category2: rule.category2,\n      category3: rule.category3,\n      needsReview: true,\n      ruleIdApplied: rule.ruleId,\n      internalTransfer: isInterno,\n      excludeFromBudget: isInterno,\n      confidence: result.confidence\n    };\n  }\n\n  return {\n    needsReview: true,\n    confidence: 0\n  };\n}\n\nexport function suggestKeyword(descNorm: string): string {\n  const parts = descNorm.split(\"--\");\n  if (parts.length > 0) {\n    const mainPart = parts[0].trim();\n    const words = mainPart.split(\" \").slice(0, 3).join(\" \");\n    return words;\n  }\n  return descNorm.slice(0, 30);\n}\n\nexport interface KeyDescMatchResult {\n  ruleId?: string;\n  leafId?: string;\n  matchedExpression?: string;\n}\n\nexport function classifyByKeyDesc(keyDesc: string, rules: Rule[]): KeyDescMatchResult {\n  for (const rule of rules.filter(r => r.active !== false && (r.keyWords || r.keywords))) {\n    const result = evaluateRuleMatch(keyDesc, rule);\n    if (result.isMatch) {\n      return {\n        ruleId: rule.id,\n        leafId: rule.leafId || undefined,\n        matchedExpression: result.positiveMatch || undefined\n      };\n    }\n  }\n\n  return {};\n}\n\nexport const AI_SEED_RULES = [\n  {\n    name: \"Interno\",\n    keywords: \"AMEX - ZAHLUNG;ZAHLUNG ERHALTEN;PAGAMENTO AMEX;PAGAMENTO M&M;AMERICAN EXPRESS ZAHLUNG;DEUTSCHE KREDITBANK;LASTSCHRIFT\",\n    type: \"Despesa\" as const,\n    fixVar: \"Fixo\" as const,\n    category1: \"Interno\" as const,\n    category2: \"Transferencias\",\n    priority: 1000,\n    strict: true,\n    isSystem: true\n  },\n  {\n    name: \"Mercado\",\n    keywords: \"REWE;EDEKA;ALDI;LIDL;NETTO;NORMA;DM;DM-DROGERIE;ROSSMANN;MUELLER;MÜLLER;ASIA MARKT;BACKSTUBE;BAECKEREI;IHLE;WUENSCHE;FRUCHTWERK\",\n    type: \"Despesa\" as const,\n    fixVar: \"Variável\" as const,\n    category1: \"Mercado\" as const,\n    category2: \"Supermercado\",\n    priority: 900,\n    strict: true,\n    isSystem: true\n  }\n  // ... more seeds can be added later if needed\n];\n","import { ParsedTransaction } from \"./types\";\n\nexport interface OCRResult {\n  date?: Date;\n  amount?: number;\n  merchant?: string;\n  confidence: number;\n}\n\nexport function parseOCRText(text: string): OCRResult {\n  // Simple Regex-based parser as a starting point\n  // 1. Find Date (DD.MM.YYYY or YYYY-MM-DD)\n  const dateMatch = text.match(/([0-9]{2})\\.([0-9]{2})\\.([0-9]{4})/);\n  let date;\n  if (dateMatch) {\n    const day = parseInt(dateMatch[1]);\n    const month = parseInt(dateMatch[2]) - 1;\n    const year = parseInt(dateMatch[3]);\n    date = new Date(year, month, day);\n  }\n\n  // 2. Find Amount (Look for largest number with 2 decimals)\n  // Regex for currency: 12,34 or 12.34\n  const amountMatches = text.matchAll(/([0-9]+[.,][0-9]{2})/g);\n  let maxAmount = 0;\n  for (const match of amountMatches) {\n    const val = parseFloat(match[1].replace(\",\", \".\"));\n    if (val > maxAmount) maxAmount = val;\n  }\n\n  // 3. Merchant (Heuristic: First line or line with \"GmbH\" etc)\n  const lines = text.split(\"\\n\").filter(l => l.trim().length > 0);\n  let merchant = lines[0]; // Fallback\n  \n  return {\n    date,\n    amount: maxAmount || undefined,\n    merchant,\n    confidence: date && maxAmount ? 0.8 : 0.4\n  };\n}\n","\"use server\";\n\nimport { auth } from \"@/auth\";\nimport { db } from \"@/lib/db\";\nimport { ingestionBatches, ingestionItems, attachments, ocrExtractions } from \"@/lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { revalidatePath } from \"next/cache\";\nimport { parseOCRText } from \"@/lib/ingest/ocr-parser\";\nimport { generateFingerprint } from \"@/lib/ingest/fingerprint\"; // We might need a different fingerprint for images\n\nexport async function uploadScreenshot(formData: FormData) {\n  const session = await auth();\n  if (!session?.user?.id) return { error: \"Unauthorized\" };\n\n  const file = formData.get(\"file\") as File;\n  const ocrText = formData.get(\"ocrText\") as string;\n\n  if (!file || !ocrText) return { error: \"Missing file or OCR text\" };\n\n  const buffer = Buffer.from(await file.arrayBuffer());\n  const filename = file.name;\n\n  try {\n    // 1. Create Ingestion Batch for this screenshot\n    const [batch] = await db.insert(ingestionBatches).values({\n      userId: session.user.id,\n      filename,\n      status: \"processing\",\n      source: \"screenshot\",\n    }).returning();\n\n    // 2. Parse OCR Text\n    const ocrResult = parseOCRText(ocrText);\n    \n    // 3. Create Ingestion Item\n    // We construct a pseudo-transaction from the OCR result\n    const txData = {\n        source: \"Screenshot\",\n        paymentDate: ocrResult.date || new Date(),\n        bookingDate: ocrResult.date || new Date(),\n        amount: ocrResult.amount || 0,\n        currency: \"EUR\",\n        descRaw: ocrResult.merchant || \"Unknown Merchant\",\n        descNorm: (ocrResult.merchant || \"\").toUpperCase(),\n        key: `OCR-${batch.id}-${Date.now()}`, // Temporary key\n        accountSource: \"Screenshot Upload\",\n        keyDesc: ocrResult.merchant || \"Unknown\",\n        simpleDesc: ocrResult.merchant || \"Unknown\",\n    };\n\n    // Fingerprint (Weak for OCR, but useful)\n    const fingerprint = generateFingerprint(txData as any); \n\n    const [item] = await db.insert(ingestionItems).values({\n        batchId: batch.id,\n        fingerprint,\n        checksum: fingerprint,\n        rawContent: JSON.stringify({ ocrResult, text: ocrText }),\n        parsedData: txData,\n        status: \"pending\",\n        source: \"screenshot\"\n    }).returning();\n\n    // 4. Save Attachment (Image) - In real app, upload to S3/Blob\n    // For now, we are skipping actual file persistence to disk to avoid complexity in this env\n    // But we record the metadata in 'attachments' table\n    await db.insert(attachments).values({\n        itemId: item.id,\n        filename,\n        mimeType: file.type,\n        sizeBytes: file.size,\n        // storagePath: \"blobs/...\", \n    });\n\n    // 5. Save OCR Extraction\n    await db.insert(ocrExtractions).values({\n        attachmentId: item.id, // Ideally attachments.id, allowing loose link\n        rawText: ocrText,\n        extractedData: ocrResult,\n    });\n\n    // 6. Complete Batch\n    await db.update(ingestionBatches)\n        .set({ \n            status: \"completed\",\n            itemsTotal: 1,\n            itemsProcessed: 1 \n        })\n        .where(eq(ingestionBatches.id, batch.id));\n\n    revalidatePath(\"/uploads\");\n    return { success: true, newItemId: item.id };\n\n  } catch (error: any) {\n    console.error(\"Screenshot upload error:\", error);\n    return { error: error.message || \"Failed to process screenshot\" };\n  }\n}\n","export {uploadIngestionFile as '407a3f0cc4f9409753076c64bf4d059136ca3b6310'} from 'ACTIONS_MODULE0'\nexport {uploadScreenshot as '40d22b12a87db984c66d69c8adf0dd769624acba4a'} from 'ACTIONS_MODULE1'\nexport {$$RSC_SERVER_ACTION_0 as '402a4846f8b56fda83f6cf523ae4b834be04abdf1e'} from 'ACTIONS_MODULE2'\nexport {getIngestionBatches as '0090d12de9c7e47325da153b3bc9efadef0aa67f80'} from 'ACTIONS_MODULE0'\nexport {uploadIngestionFile as '407a3f0cc4f9409753076c64bf4d059136ca3b6310'} from 'ACTIONS_MODULE0'\nexport {rollbackBatch as '40890ea937076b4cd15f23584f23bfd6d2f4f7b914'} from 'ACTIONS_MODULE0'\nexport {commitBatch as '40acf1c5af35b826575fafbe812a353948eda3a858'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"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","ignoreList":[0,1,3,5,6]}